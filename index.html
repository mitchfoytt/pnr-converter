<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Missive Iframe App</title>

  <!-- Missive CSS + JS -->
  <link href="https://integrations.missiveapp.com/missive.css" rel="stylesheet">
  <script src="https://integrations.missiveapp.com/missive.js"></script>
  <style>
    :root {
      --missive-background-color: #f5f6f7;
      --base-color-brand--tt-green: #20c997;
      --base-color-neutral--300: #d0d3d6;
      --base-color-neutral--black: #1f1f1f;
      --base-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
    }
  </style>
</head>
<body style="background-color: var(--missive-background-color); padding: 16px;">

  <!-- Heading -->
  <h1 class="text-large" style="margin-bottom: 12px;">Travel Tailor - PNR Converter</h1>

  <div class="columns-vertical" style="gap: 12px;">
    <div style="background: white; border: 1px solid var(--base-color-neutral--300); padding: 12px; border-radius: 6px;">
      <textarea id="pnrInput" class="input" rows="6" placeholder="Paste PNR here..." style="width: 100%; border: none; outline: none; resize: vertical;"></textarea>
    </div>
    <!-- Button -->
    <button id="submitBtn" class="button button-async">
      <span class="button-async-label">Convert PNR</span>
      <div class="loading-icon">
        <i class="icon icon-circle" style="width: 24px; height: 24px;">
          <svg style="width: 24px; height: 24px;">
            <use xlink:href="#circle" />
          </svg>
        </i>
      </div>
    </button>
  </div>

  <!-- Output Placeholder -->
  <div id="output" class="text-small" style="display: none; white-space: pre-wrap; border: 1px solid var(--base-color-neutral--300); background: white; padding: 12px; border-radius: 6px; min-height: 80px; margin-top: 16px;">
    Output will appear here...
  </div>
  <button id="copyBtn" class="button" style="display: none; margin-top: 12px;">
    Copy Table
  </button>

</script>
  <script>
    document.getElementById('submitBtn').addEventListener('click', () => {
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.classList.add('button-async--loading');

      const output = document.getElementById('output');
      const pnrText = document.getElementById('pnrInput').value.trim();

      if (pnrText) {
        // Simulate async delay
        setTimeout(() => {
          output.style.display = 'block';
          output.textContent = 'Result:\n' + pnrText;

          const copyBtn = document.getElementById('copyBtn');
          copyBtn.style.display = 'inline-block';

          submitBtn.classList.remove('button-async--loading');

          copyBtn.onclick = () => {
            navigator.clipboard.writeText(output.textContent)
              .then(() => {
                copyBtn.textContent = 'Copied!';
                setTimeout(() => {
                  copyBtn.textContent = 'Copy Table';
                }, 1500);
              });
          };
        }, 1500); // simulate 1.5s delay
      } else {
        output.style.display = 'none';
        document.getElementById('copyBtn').style.display = 'none';
        submitBtn.classList.remove('button-async--loading');
      }
    });
  </script>
</body>
</html>
